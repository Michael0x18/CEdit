#include <stdio.h>
#include <stdlib.h>
#include <tice.h>
#include <keypadc.h>
#include <graphx.h>
#include <string.h>

#include "cedit.h"

int main(void)
{
	static uint8_t font_buffer[128][8][8];
	x4_Begin();
	x4_LoadDefaultPalette();
	x4_FillScreen(15);
	x4_load_default_font(font_buffer,0,15);
	//x4_Line_EFLA(0,0,20,20,2);
	//x4_HorizLine(10,10,100,1);
	for(int i = 0; i < 231; i+=17)
		x4_PutStr(font_buffer,0,i,"012345678901234567890123456789");
	
	x4_SetDrawLocation(X4_BUFFER_2);
	x4_FillScreen(15);
	
	while(!kb_IsDown(kb_KeyClear)){
		kb_Scan();
	}

	x4_SetScreenLocation(X4_BUFFER_1);
	x4_End();
}





/*
#define lcd_CrsrImage ((uint32_t*)0xE30800)

unsigned char cursor_bin[] = {
  0x00, 0x00, 0x00, 0x00, 0x2a, 0xaa, 0xaa, 0xaa, 0x85, 0x55, 0x55, 0x55,
  0x2a, 0xaa, 0xaa, 0xaa, 0xa1, 0x55, 0x55, 0x54, 0xaa, 0xaa, 0xaa, 0xaa,
  0xa8, 0x55, 0x55, 0x52, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0x15, 0x55, 0x4a,
  0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0x85, 0x55, 0x50, 0xaa, 0xaa, 0xaa, 0xaa,
  0xaa, 0xa1, 0x55, 0x55, 0x0a, 0xaa, 0xaa, 0xaa, 0xaa, 0xa8, 0x55, 0x05,
  0x52, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0x15, 0x20, 0x52, 0xaa, 0xaa, 0xaa,
  0xaa, 0xaa, 0x85, 0x2a, 0x0a, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xa1, 0x2a,
  0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xa8, 0x2a, 0xaa, 0xaa, 0xaa, 0xaa,
  0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
  0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
  0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
  0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
  0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
  0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
  0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
  0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
  0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
  0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
  0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
  0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
  0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
  0xaa, 0xaa, 0xaa, 0xaa
};
unsigned int cursor_bin_len = 256;


void main(void) {
	bool frame = false;
	x4_Begin();
	x4_LoadDefaultPalette();
	x4_FillScreen(15);
	uint16_t x = 0, y = 0;
	
	// set the CPL
	//lcd_Timing2 = (uint32_t)(lcd_Timing2 & ~(uint32_t)0x03FF0000) | (uint32_t)(LCD_WIDTH - 1) << 16;
	memcpy(lcd_CrsrImage, cursor_bin, 256); // set cursor image

	lcd_CrsrConfig = 0; // select 32x32, image0
	lcd_CrsrPalette0 = 0x00000000; // set black palette color
	lcd_CrsrPalette1 = 0x00FFFFFF; // set white palette color
	lcd_CrsrXY = 0; // reset cursor position
	lcd_CrsrClip = 0; // reset clipping
	lcd_CrsrCtrl = 1; // enable cursor
	int bg=15;
	x4_SetDrawLocation(X4_BUFFER_2);
	                x4_SetScreenLocation(X4_BUFFER_1);

	while(!kb_IsDown(kb_KeyClear)) {
		kb_Scan();
		if(kb_IsDown(kb_KeyLeft)) x--;
		if(kb_IsDown(kb_KeyRight)) x++;
		if(kb_IsDown(kb_KeyUp)) y--;
		if(kb_IsDown(kb_KeyDown)) y++;
		if(x>1000)x=0;
		if(x>=320)x=319;
		if(y>1000)y=0;
		if(y>=240)y=239;
		lcd_CrsrY = x; // update the position of the cursor
		lcd_CrsrX = y;
		if(kb_IsDown(kb_KeyEnter)){
			bg++;
			if(bg>15)
				bg=0;
			x4_FillScreen(bg);
			frame=!frame;
			if(frame){
				x4_SetDrawLocation(X4_BUFFER_1);
				x4_SetScreenLocation(X4_BUFFER_2);
			}else{
				x4_SetDrawLocation(X4_BUFFER_2);
				x4_SetScreenLocation(X4_BUFFER_1);
			}
			while(kb_IsDown(kb_KeyEnter)){
				delay(10);
				kb_Scan();
			}
		}
	}

	lcd_CrsrCtrl = 0; // disable cursor
	x4_SetScreenLocation(X4_BUFFER_1);
	x4_End();
}*/
